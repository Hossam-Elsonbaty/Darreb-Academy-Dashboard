<div class="flex flex-col gap-5">
  <div class="border-l-4 border-green-400 pl-5 flex justify-between items-center">
    <h1 class="font-bold text-2xl w-fit">Chapters</h1>
    <button
      (click)="openChapterModal()"
      class="w-max p-2 flex items-center gap-3 px-4 text-lg rounded-lg bg-green-500 text-white cursor-pointer"
    >
      <span class="pi pi-plus text-lg"></span>
      Add New chapter
    </button>
  </div>

  <div
    class="relative overflow-x-auto bg-neutral-primary-soft shadow-xs rounded-base border border-default"
  >
    <table class="w-full text-sm text-left rtl:text-right text-body">
      <thead class="text-sm text-body bg-neutral-secondary-medium border-b border-default-medium">
        <tr>
          <th scope="col" class="px-6 py-3 font-medium">Title</th>
          <th scope="col" class="px-6 py-3 font-medium">Title_ar</th>
          <th scope="col" class="px-6 py-3 font-medium">Duration</th>
          <th scope="col" class="px-6 py-3 font-medium">Options</th>
        </tr>
      </thead>
      <tbody>
        @for (chapter of chapters; track chapter._id) {
        <tr>
          <td class="px-6 py-4 font-medium text-heading whitespace-nowrap">
            {{ chapter.title }}
          </td>
          <td class="px-6 py-4">
            {{ chapter.title_ar }}
          </td>
          <td class="px-6 py-4">
            {{ chapter.duration }}
          </td>
          <td class="px-6 py-4">
            <div class="flex items-center gap-4">
              <button class="cursor-pointer" (click)="updateChapter(chapter._id)">
                <span class="pi pi-pencil text-lg text-green-500"></span>
              </button>

              <!-- DELETE -->
              <button class="cursor-pointer" (click)="openDeleteChapterModal(chapter._id)">
                <span class="pi pi-trash text-lg text-red-500"></span>
              </button>
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
  <!-- Delete Confirmation Modal -->
  <div
    [ngClass]="{
      hidden: !isDeleteModalOpen,
      flex: isDeleteModalOpen
    }"
    class="fixed inset-0 items-center justify-center bg-black/20 z-50"
  >
    <div
      class="relative overflow-x-auto bg-neutral-primary-soft shadow-xs rounded-base border border-default p-6 w-96"
    >
      <h2 class="text-lg font-bold mb-4">Delete Chapter</h2>
      <p class="mb-6">Are you sure you want to delete this chapter?</p>
      <div class="flex justify-end gap-3">
        <button (click)="cancelDelete()" class="cursor-pointer px-4 py-2 bg-gray-300 rounded">
          Cancel
        </button>
        <button
          (click)="confirmDeleteYes()"
          class="cursor-pointer px-4 py-2 bg-red-500 text-white rounded"
        >
          Delete
        </button>
      </div>
    </div>
  </div>
  <app-add-chapter-modal-component
    [isOpen]="isChapterModalOpen"
    [courseId]="courseId"
    [chapterToEdit]="selectedChapter"
    (refreshList)="onChapterCreated($event)"
    (chapterUpdated)="onChapterUpdate($event)"
    (closeModal)="isChapterModalOpen = false"
  >
  </app-add-chapter-modal-component>
</div>
